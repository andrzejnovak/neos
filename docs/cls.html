---

title: fullstream.cls

keywords: fastai
sidebar: home_sidebar

summary: "Module containing the differentiable calculation of CLs values."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 06_cls.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="cls_jax" class="doc_header"><code>cls_jax</code><a href="https://github.com/phinate/fullstream/tree/master/fullstream/cls.py#L20" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>cls_jax</code>(<strong><code>nn_params</code></strong>, <strong><code>test_mu</code></strong>, <strong><code>transforms</code></strong>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fullstream.nn</span> <span class="kn">import</span> <span class="n">three_blob_classifier</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">three_blob_classifier</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">num_epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">nn_params</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">params</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/phinate/envs/fullstream/lib/python3.7/site-packages/jax-0.1.58-py3.7.egg/jax/lib/xla_bridge.py:119: UserWarning: No GPU/TPU found, falling back to CPU.
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
Starting training...
Epoch 0 in 2.87 sec
Training set accuracy 0.8476
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAV0AAADnCAYAAAC9roUQAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADt0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjByYzMsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy9h23ruAAADKUlEQVR4nO3UMQEAIAzAMMC/5+GiHCQKenXPzAKgcV4HAPzEdAFCpgsQMl2AkOkChEwXIGS6ACHTBQiZLkDIdAFCpgsQMl2AkOkChEwXIGS6ACHTBQiZLkDIdAFCpgsQMl2AkOkChEwXIGS6ACHTBQiZLkDIdAFCpgsQMl2AkOkChEwXIGS6ACHTBQiZLkDIdAFCpgsQMl2AkOkChEwXIGS6ACHTBQiZLkDIdAFCpgsQMl2AkOkChEwXIGS6ACHTBQiZLkDIdAFCpgsQMl2AkOkChEwXIGS6ACHTBQiZLkDIdAFCpgsQMl2AkOkChEwXIGS6ACHTBQiZLkDIdAFCpgsQMl2AkOkChEwXIGS6ACHTBQiZLkDIdAFCpgsQMl2AkOkChEwXIGS6ACHTBQiZLkDIdAFCpgsQMl2AkOkChEwXIGS6ACHTBQiZLkDIdAFCpgsQMl2AkOkChEwXIGS6ACHTBQiZLkDIdAFCpgsQMl2AkOkChEwXIGS6ACHTBQiZLkDIdAFCpgsQMl2AkOkChEwXIGS6ACHTBQiZLkDIdAFCpgsQMl2AkOkChEwXIGS6ACHTBQiZLkDIdAFCpgsQMl2AkOkChEwXIGS6ACHTBQiZLkDIdAFCpgsQMl2AkOkChEwXIGS6ACHTBQiZLkDIdAFCpgsQMl2AkOkChEwXIGS6ACHTBQiZLkDIdAFCpgsQMl2AkOkChEwXIGS6ACHTBQiZLkDIdAFCpgsQMl2AkOkChEwXIGS6ACHTBQiZLkDIdAFCpgsQMl2AkOkChEwXIGS6ACHTBQiZLkDIdAFCpgsQMl2AkOkChEwXIGS6ACHTBQiZLkDIdAFCpgsQMl2AkOkChEwXIGS6ACHTBQiZLkDIdAFCpgsQMl2AkOkChEwXIGS6ACHTBQiZLkDIdAFCpgsQMl2AkOkChEwXIGS6ACHTBQiZLkDIdAFCpgsQMl2AkOkChEwXIGS6ACHTBQiZLkDIdAFCpgsQMl2AkOkChEwXIGS6ACHTBQiZLkDIdAFCpgsQMl2AkOkChEwXIGS6ACHTBQiZLkDIdAFCpgsQMl2AkOkChEwXIHQBcjcEy3+fc28AAAAASUVORK5CYII=
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cls_jax</span><span class="p">(</span><span class="n">nn_params</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>model: [ 6.40477037 13.59522963],[43.13707402  6.86292598],[4.44113382 4.44113382]
model: Traced&lt;ShapedArray(float64[2]):JaxprTrace(level=0/0)&gt;,Traced&lt;ShapedArray(float64[2]):JaxprTrace(level=0/0)&gt;,Traced&lt;ShapedArray(float64[2]):JaxprTrace(level=0/0)&gt;
model: Traced&lt;ShapedArray(float64[2]):JaxprTrace(level=0/0)&gt;,Traced&lt;ShapedArray(float64[2]):JaxprTrace(level=0/0)&gt;,Traced&lt;ShapedArray(float64[2]):JaxprTrace(level=0/0)&gt;
constrained fit: [1.         0.96071416]
global fit: [0.01694888 1.0021199 ]
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>DeviceArray(0.42813986, dtype=float64)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cls_jax</span><span class="p">(</span><span class="n">nn_params</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>model: [ 6.40477037 13.59522963],[43.13707402  6.86292598],[4.44113382 4.44113382]
model: Traced&lt;ShapedArray(float64[2]):JaxprTrace(level=0/0)&gt;,Traced&lt;ShapedArray(float64[2]):JaxprTrace(level=0/0)&gt;,Traced&lt;ShapedArray(float64[2]):JaxprTrace(level=0/0)&gt;
model: Traced&lt;ShapedArray(float64[2]):JaxprTrace(level=0/0)&gt;,Traced&lt;ShapedArray(float64[2]):JaxprTrace(level=0/0)&gt;,Traced&lt;ShapedArray(float64[2]):JaxprTrace(level=0/0)&gt;
constrained fit: [ 1. 10.]
global fit: [0.         0.59398947]
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>DeviceArray(0., dtype=float64)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}
</div>
 

