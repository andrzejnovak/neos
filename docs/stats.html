---

title: fullstream.stats

keywords: fastai
sidebar: home_sidebar

summary: "Module for statistical computation in the context of particle physics inference."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 01_stats.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="hists_from_nn" class="doc_header"><code>hists_from_nn</code><a href="https://github.com/phinate/fullstream/tree/master/fullstream/stats.py#L12" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>hists_from_nn</code>(<strong><code>nn</code></strong>, <strong><code>params</code></strong>, <strong><code>sigevents</code></strong>, <strong><code>bkgevents</code></strong>, <strong><code>scale</code></strong>=<em><code>False</code></em>, <strong><code>use_jax</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Create nn-based binned summary statistics from signal and background events.
nn should be a predict method that's callable on arguments (data,params), and have a logsoftmax output.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fullstream.nn</span> <span class="kn">import</span> <span class="n">simple_classifier</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/phinate/envs/fullstream/lib/python3.7/site-packages/jax-0.1.58-py3.7.egg/jax/lib/xla_bridge.py:119: UserWarning: No GPU/TPU found, falling back to CPU.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">simple_classifier</span><span class="p">(</span><span class="n">dist</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
Starting training...
Epoch 0 in 3.20 sec
Training set accuracy 0.87475
Epoch 1 in 2.76 sec
Training set accuracy 0.9105
Epoch 2 in 2.81 sec
Training set accuracy 0.9246
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sighist</span><span class="p">,</span> <span class="n">bkghist</span> <span class="o">=</span> <span class="n">hists_from_nn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">gen_sig</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span> <span class="n">x</span><span class="o">.</span><span class="n">gen_bkg</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_jax</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>0 --&gt; NN thinks it's background</li>
<li>1 --&gt; NN thinks it's signal</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">bkghist</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;background hist&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">sighist</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">bkghist</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;signal hist&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.legend.Legend at 0x7f727816fa50&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="simple_nn_logpdf" class="doc_header"><code>simple_nn_logpdf</code><a href="https://github.com/phinate/fullstream/tree/master/fullstream/stats.py#L30" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>simple_nn_logpdf</code>(<strong><code>nn_pars</code></strong>, <strong><code>nn</code></strong>, <strong><code>pars</code></strong>, <strong><code>data</code></strong>, <strong><code>sig_data</code></strong>, <strong><code>bkg_data</code></strong>, <strong><code>bkg_uncerts</code></strong>, <strong><code>use_jax</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Return pyhf.Model.logpdf for a simple two-bin model, containing a signal and background histogram created using hists_from_nn.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">jax</span> <span class="kn">import</span> <span class="n">grad</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># with numpy</span>
<span class="n">simple_nn_logpdf</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">params</span><span class="p">,</span>
                 <span class="n">nn</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
                 <span class="n">pars</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">],</span>
                 <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mf">100.</span><span class="p">,</span><span class="mf">20.</span><span class="p">],</span>
                 <span class="n">sig_data</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">gen_sig</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span>
                 <span class="n">bkg_data</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">gen_bkg</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span>
                 <span class="n">bkg_uncerts</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span>
                 <span class="n">use_jax</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{&#39;channels&#39;: [{&#39;name&#39;: &#39;singlechannel&#39;, &#39;samples&#39;: [{&#39;name&#39;: &#39;signal&#39;, &#39;data&#39;: array([ 3.57937456, 16.42062544]), &#39;modifiers&#39;: [{&#39;name&#39;: &#39;mu&#39;, &#39;type&#39;: &#39;normfactor&#39;, &#39;data&#39;: None}]}, {&#39;name&#39;: &#39;background&#39;, &#39;data&#39;: array([90.37500699,  9.62499301]), &#39;modifiers&#39;: [{&#39;name&#39;: &#39;uncorr_bkguncrt&#39;, &#39;type&#39;: &#39;shapesys&#39;, &#39;data&#39;: array([90.37500699,  9.62499301])}]}]}]}
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>DeviceArray(-8.59706471, dtype=float64)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># with jax</span>
<span class="n">grad</span><span class="p">(</span><span class="n">simple_nn_logpdf</span><span class="p">)(</span><span class="n">x</span><span class="o">.</span><span class="n">params</span><span class="p">,</span>
                       <span class="n">nn</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
                       <span class="n">pars</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">],</span>
                       <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mf">100.</span><span class="p">,</span><span class="mf">20.</span><span class="p">],</span>
                       <span class="n">sig_data</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">gen_sig</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span>
                       <span class="n">bkg_data</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">gen_bkg</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span>
                       <span class="n">bkg_uncerts</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span>
                       <span class="n">use_jax</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{&#39;channels&#39;: [{&#39;name&#39;: &#39;singlechannel&#39;, &#39;samples&#39;: [{&#39;name&#39;: &#39;signal&#39;, &#39;data&#39;: Traced&lt;ConcreteArray([ 3.57937456 16.42062544])&gt;with&lt;JVPTrace(level=1/0)&gt;, &#39;modifiers&#39;: [{&#39;name&#39;: &#39;mu&#39;, &#39;type&#39;: &#39;normfactor&#39;, &#39;data&#39;: None}]}, {&#39;name&#39;: &#39;background&#39;, &#39;data&#39;: Traced&lt;ConcreteArray([90.37500699  9.62499301])&gt;with&lt;JVPTrace(level=1/0)&gt;, &#39;modifiers&#39;: [{&#39;name&#39;: &#39;uncorr_bkguncrt&#39;, &#39;type&#39;: &#39;shapesys&#39;, &#39;data&#39;: Traced&lt;ConcreteArray([90.37500699  9.62499301])&gt;with&lt;JVPTrace(level=1/0)&gt;}]}]}]}
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[(DeviceArray([[-1.23084869e+01,  5.56208658e+00,  3.23549932e-04,
                 1.93820204e-04,  1.36456175e+01,  0.00000000e+00,
                 0.00000000e+00, -1.01762481e-07,  0.00000000e+00,
                 1.39686184e+01],
               [-1.67865543e+01,  7.58433676e+00,  9.15458295e-05,
                 5.29033168e-05,  1.86071892e+01,  0.00000000e+00,
                 0.00000000e+00,  6.07859306e-07,  0.00000000e+00,
                 1.90502663e+01]], dtype=float32),
  DeviceArray([-3.3381634e+00,  1.5081198e+00,  4.9363494e-05,
                3.0261819e-05,  3.6999438e+00,  0.0000000e+00,
                0.0000000e+00,  1.4742641e-07,  0.0000000e+00,
                3.7882504e+00], dtype=float32)),
 (),
 (DeviceArray([[ 7.3315840e+00, -7.3315840e+00],
               [ 2.1346252e+00, -2.1346252e+00],
               [ 3.3933472e-06, -3.3933472e-06],
               [ 5.3991002e-06, -5.3991002e-06],
               [ 4.8403034e+00, -4.8403034e+00],
               [ 0.0000000e+00,  0.0000000e+00],
               [ 0.0000000e+00,  0.0000000e+00],
               [ 7.0510526e-07, -7.0510526e-07],
               [ 0.0000000e+00,  0.0000000e+00],
               [ 5.3927464e+00, -5.3927464e+00]], dtype=float32),
  DeviceArray([ 2.4538043, -2.4538043], dtype=float32)),
 ()]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="hists_from_nn_uncert" class="doc_header"><code>hists_from_nn_uncert</code><a href="https://github.com/phinate/fullstream/tree/master/fullstream/stats.py#L73" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>hists_from_nn_uncert</code>(<strong><code>nn</code></strong>, <strong><code>params</code></strong>, <strong><code>sig</code></strong>, <strong><code>bkg1</code></strong>, <strong><code>bkg2</code></strong>, <strong><code>scale</code></strong>=<em><code>True</code></em>, <strong><code>use_jax</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Create nn-based binned summary statistics from signal and background events.
nn should be a predict method that's callable on arguments (data,params), and have a logsoftmax output.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_event_data</span><span class="p">(</span><span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]):</span>
    <span class="n">k1</span><span class="p">,</span><span class="n">k2</span><span class="p">,</span><span class="n">k3</span> <span class="o">=</span> <span class="n">keys</span>
    <span class="n">sig</span>  <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="n">k1</span><span class="p">),</span> <span class="n">jax</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">]),</span> <span class="n">jax</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mi">1</span><span class="p">]]),</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5000</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">bkg1</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="n">k2</span><span class="p">),</span> <span class="n">jax</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">]),</span> <span class="n">jax</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.6</span><span class="p">],[</span><span class="mf">0.6</span><span class="p">,</span><span class="mi">1</span><span class="p">]]),</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5000</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">bkg2</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="n">k3</span><span class="p">),</span> <span class="n">jax</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">5.5</span><span class="p">,</span><span class="mf">4.5</span><span class="p">]),</span> <span class="n">jax</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">([[</span><span class="mf">1.7</span><span class="p">,</span><span class="mf">0.2</span><span class="p">],[</span><span class="mf">0.2</span><span class="p">,</span><span class="mi">1</span><span class="p">]]),</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5000</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">sig</span><span class="p">,</span><span class="n">bkg1</span><span class="p">,</span><span class="n">bkg2</span>


<span class="n">hists_from_nn_uncert</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">bkg1</span><span class="p">,</span> <span class="n">bkg2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">nn_model</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span><span class="n">nn_pars</span><span class="p">,</span><span class="n">pars</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">sig_data</span><span class="p">,</span><span class="n">bkg_data1</span><span class="p">,</span><span class="n">bkg_data2</span><span class="p">,</span><span class="n">use_jax</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Return pyhf.Model.logpdf for a simple two-bin model, containing a signal and background histogram created using hists_from_nn.&#39;&#39;&#39;</span>
        <span class="n">tensorlib</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">pyhf</span><span class="o">.</span><span class="n">get_backend</span><span class="p">()</span>
        
        <span class="n">sig_hist</span><span class="p">,</span> <span class="n">bkg_hist</span> <span class="n">bkg_uncert</span> <span class="o">=</span> <span class="n">hists_from_nn_uncert</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="n">nn_pars</span><span class="p">,</span> <span class="n">sig_data</span><span class="p">,</span> <span class="n">bkg_data1</span><span class="p">,</span> <span class="n">bkg_data2</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_jax</span><span class="o">=</span><span class="n">use_jax</span><span class="p">)</span> 
        
        <span class="n">spec</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;channels&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;singlechannel&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;samples&#39;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">{</span>
                            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;signal&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">sig_hist</span><span class="p">,</span>
                            <span class="s1">&#39;modifiers&#39;</span><span class="p">:</span> <span class="p">[</span>
                                <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;mu&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;normfactor&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
                            <span class="p">],</span>
                        <span class="p">},</span>
                        <span class="p">{</span>
                            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;background&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">bkg_hist</span><span class="p">,</span>
                            <span class="s1">&#39;modifiers&#39;</span><span class="p">:</span> <span class="p">[</span>
                                <span class="p">{</span>
                                    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;uncorr_bkguncrt&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;shapesys&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">bkg_uncert</span><span class="p">,</span>
                                <span class="p">}</span>
                            <span class="p">],</span>
                        <span class="p">},</span>
                    <span class="p">],</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">pyhf</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">+=</span> <span class="n">model</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">auxdata</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">tensorlib</span><span class="o">.</span><span class="n">astensor</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">pars</span> <span class="o">=</span> <span class="n">tensorlib</span><span class="o">.</span><span class="n">astensor</span><span class="p">(</span><span class="n">pars</span><span class="p">)</span>

        <span class="c1"># grad only defined for scalar output functions, not [scalar]</span>
        <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span><span class="n">data</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}
</div>
 

