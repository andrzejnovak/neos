---

title: fullstream.stats

keywords: fastai
sidebar: home_sidebar

summary: "Module for statistical computation in the context of particle physics inference."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 01_stats.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="hists_from_nn" class="doc_header"><code>hists_from_nn</code><a href="https://github.com/phinate/fullstream/tree/master/fullstream/stats.py#L12" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>hists_from_nn</code>(<strong><code>nn</code></strong>, <strong><code>params</code></strong>, <strong><code>sigevents</code></strong>, <strong><code>bkgevents</code></strong>, <strong><code>scale</code></strong>=<em><code>False</code></em>, <strong><code>use_jax</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Create nn-based binned summary statistics from signal and background events.
nn should be a predict method that's callable on arguments (data,params), and have a logsoftmax output.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fullstream.nn</span> <span class="kn">import</span> <span class="n">simple_classifier</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/phinate/miniconda3/lib/python3.7/site-packages/jax/lib/xla_bridge.py:119: UserWarning: No GPU/TPU found, falling back to CPU.
  warnings.warn(&#39;No GPU/TPU found, falling back to CPU.&#39;)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">simple_classifier</span><span class="p">(</span><span class="n">dist</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
Starting training...
Epoch 0 in 4.02 sec
Training set accuracy 0.87475
Epoch 1 in 3.29 sec
Training set accuracy 0.9105
Epoch 2 in 4.23 sec
Training set accuracy 0.9246
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sighist</span><span class="p">,</span> <span class="n">bkghist</span> <span class="o">=</span> <span class="n">hists_from_nn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">gen_sig</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span> <span class="n">x</span><span class="o">.</span><span class="n">gen_bkg</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_jax</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>0 --&gt; NN thinks it's background</li>
<li>1 --&gt; NN thinks it's signal</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">bkghist</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;background hist&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">sighist</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">bkghist</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;signal hist&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.legend.Legend at 0x7fe3d1313810&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="simple_nn_logpdf" class="doc_header"><code>simple_nn_logpdf</code><a href="https://github.com/phinate/fullstream/tree/master/fullstream/stats.py#L30" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>simple_nn_logpdf</code>(<strong><code>nn_pars</code></strong>, <strong><code>nn</code></strong>, <strong><code>pars</code></strong>, <strong><code>data</code></strong>, <strong><code>sig_data</code></strong>, <strong><code>bkg_data</code></strong>, <strong><code>bkg_uncerts</code></strong>, <strong><code>use_jax</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Return pyhf.Model.logpdf for a simple two-bin model, containing a signal and background histogram created using hists_from_nn.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">jax</span> <span class="kn">import</span> <span class="n">grad</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># with numpy</span>
<span class="n">simple_nn_logpdf</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">params</span><span class="p">,</span>
                 <span class="n">nn</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
                 <span class="n">pars</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">],</span>
                 <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mf">100.</span><span class="p">,</span><span class="mf">20.</span><span class="p">],</span>
                 <span class="n">sig_data</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">gen_sig</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span>
                 <span class="n">bkg_data</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">gen_bkg</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span>
                 <span class="n">bkg_uncerts</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span>
                 <span class="n">use_jax</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>DeviceArray(-11.35564634, dtype=float64)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># with jax</span>
<span class="n">grad</span><span class="p">(</span><span class="n">simple_nn_logpdf</span><span class="p">)(</span><span class="n">x</span><span class="o">.</span><span class="n">params</span><span class="p">,</span>
                       <span class="n">nn</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
                       <span class="n">pars</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">],</span>
                       <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mf">100.</span><span class="p">,</span><span class="mf">20.</span><span class="p">],</span>
                       <span class="n">sig_data</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">gen_sig</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span>
                       <span class="n">bkg_data</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">gen_bkg</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span>
                       <span class="n">bkg_uncerts</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span>
                       <span class="n">use_jax</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[(DeviceArray([[-1.23084898e+01,  5.56208515e+00,  3.23549903e-04,
                 1.93820204e-04,  1.36456146e+01,  0.00000000e+00,
                 0.00000000e+00, -1.01762446e-07,  0.00000000e+00,
                 1.39686193e+01],
               [-1.67865562e+01,  7.58433485e+00,  9.15458222e-05,
                 5.29033096e-05,  1.86071854e+01,  0.00000000e+00,
                 0.00000000e+00,  6.07858965e-07,  0.00000000e+00,
                 1.90502701e+01]], dtype=float32),
  DeviceArray([-3.3381641e+00,  1.5081193e+00,  4.9363491e-05,
                3.0261817e-05,  3.6999431e+00,  0.0000000e+00,
                0.0000000e+00,  1.4742631e-07,  0.0000000e+00,
                3.7882507e+00], dtype=float32)),
 (),
 (DeviceArray([[ 7.3315835e+00, -7.3315835e+00],
               [ 2.1346250e+00, -2.1346250e+00],
               [ 3.3933479e-06, -3.3933479e-06],
               [ 5.3991025e-06, -5.3991025e-06],
               [ 4.8403077e+00, -4.8403077e+00],
               [ 0.0000000e+00,  0.0000000e+00],
               [ 0.0000000e+00,  0.0000000e+00],
               [ 7.0510544e-07, -7.0510544e-07],
               [ 0.0000000e+00,  0.0000000e+00],
               [ 5.3927441e+00, -5.3927441e+00]], dtype=float32),
  DeviceArray([ 2.4538045, -2.4538045], dtype=float32)),
 ()]</pre>
</div>

</div>

</div>
</div>

</div>
</div>
 

